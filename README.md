## 🔍 프로젝트 소개

망분리(Network Segregation)는 기업과 정부기관에서 내부망과 인터넷망을 물리적으로 분리해 사이버 보안을 강화하는 중요한 전략입니다. 하지만 망분리 환경에서도 내부자의 의도적인 보안 위반이나 사용자 실수로 인한 네트워크 혼용이 빈번히 발생하며, 기존의 방화벽(Firewall), 침입탐지시스템(IDS), 네트워크 접근제어(NAC)와 같은 보안 솔루션만으로는 이런 위협을 완벽히 차단하기 어렵습니다.

본 프로젝트는 망분리 환경에서 발생 가능한 내부 보안 위협을 조기에 탐지하고 대응하기 위한 **실시간 이상 트래픽 탐지 및 차단 시스템**을 제안합니다. 본 연구는 특히 **Variational Autoencoder(VAE)**, **Anomaly Transformer**, **나이브 베이즈(Naive Bayes)** 기법을 결합하여 비정상 트래픽을 정확히 탐지하고, 단말의 이상행위를 확률적으로 평가하여 효과적으로 관리할 수 있는 앙상블 기법을 제시합니다.

본 시스템의 주요 기능은 다음과 같습니다.

* SNMP, TAP, Arkime 기반의 다차원 네트워크 트래픽 실시간 수집 및 분석
* VAE를 활용한 세션 단위 이상행위 탐지 및 차원 축소(latent vector) 분석
* Anomaly Transformer를 이용한 시계열 기반 세션 흐름 이상행위 탐지
* 나이브 베이즈 기법을 이용한 단말별 이상행위 확률적 평가 및 우선순위 지정

본 앙상블 접근법을 통해 내부자 위협, 네트워크 혼용, 암호화된 트래픽 내 이상징후 등을 기존 방식보다 훨씬 정밀하게 탐지하며, 궁극적으로 물리적 망분리 환경에서 강력한 **실시간 보안 관제 인프라 구축**에 기여하고자 합니다.


![image](https://github.com/user-attachments/assets/e59eee47-85a9-4ae6-bb57-fc14b4a7ee6d)

## 🌐 망분리(Network Segregation) 환경의 네트워크 구성도

본 그림은 망분리 환경에서 기관 및 기업이 일반적으로 사용하는 네트워크 구성을 나타내고 있습니다. 망분리 환경은 주로 아래와 같이 세 가지 영역으로 구성됩니다:

* **인터넷 네트워크(Internet Network)**: 외부 인터넷과 직접 연결되어 있으며, 다양한 보안 장치를 통해 외부 위협을 탐지하고 차단합니다. 또한 웹 서비스를 안전하게 제공하기 위해 DMZ(Demilitarized Zone) 영역을 운영합니다.
* **사설 네트워크(Private Network)**: 내부 업무망으로, 인터넷망과 완전히 격리하여 기밀성을 유지하고 데이터의 무결성을 확보합니다. 중요한 내부 서비스 및 보안 시스템이 위치합니다.
* **사용자 영역(User Area)**: 실제 사용자들이 업무를 수행하는 구역으로, 인터넷망과 내부 업무망이 동시에 제공되어 사용자 편의성을 지원합니다.

망분리 환경의 도입은 보안성 강화와 데이터 보호라는 측면에서 명확한 이점을 제공합니다. 하지만 관리적인 관점에서 볼 때는 관리해야 할 네트워크 포인트가 증가하여 관리 복잡성 및 운영 비용이 증가할 수 있습니다.

특히 사용자 영역에서는 사용자가 정확히 인지하지 못하고 업무망과 인터넷망을 혼용할 가능성이 있으며, 이는 내부 데이터가 외부로 노출되는 심각한 보안 위협을 초래할 수 있습니다. 또한 관리자의 실수나 잘못된 네트워크 설정으로 인해 네트워크 혼용이 발생할 수 있어 보안상 문제가 지속적으로 발생합니다.



## 📊 데이터 수집 및 처리 방법

본 프로젝트에서는 망분리 환경에서 정확하고 신뢰성 높은 이상 탐지 시스템을 구현하기 위해 데이터의 정확성과 무결성을 확보하는 것이 중요합니다. 따라서 다음과 같은 단계로 데이터를 수집하고 처리하였습니다.

![image](https://github.com/user-attachments/assets/8b75728e-db3f-42b2-9277-d45c483ced95)

### 🔹 데이터 수집 환경 구축

* **네트워크 트래픽 실시간 캡처**

  * **Arkime와 Wireshark** 등을 사용하여 실시간 네트워크 트래픽과 세션 데이터를 캡처·분석합니다.
  * 네트워크의 미러링 포트와 TAP(Test Access Point)를 통해 모든 VLAN의 트래픽을 수집하고, 이를 분석 서버로 집약하여 관리합니다.

* **스위치 포트 통계 정보 수집**

  * SNMP(Simple Network Management Protocol)를 이용하여 브로드캐스트, 멀티캐스트, 유니캐스트, 오류 패킷 등 다양한 포트 통계 정보를 실시간으로 수집하고 분석에 활용합니다.

### 🔹 데이터 정확성 및 무결성 보장 방법

* **다중 네트워크 혼용 탐지**

  * 여러 네트워크가 사용자 실수 또는 의도적인 혼용으로 인해 연결될 경우 심각한 보안 위협이 발생할 수 있습니다. 따라서 이를 방지하기 위해 스위치 장비의 SNMP 정보를 활용하여 네트워크 혼용 상태를 탐지합니다.
  * IP와 MAC 정보를 분석하여 비정상적 네트워크 연결 상태를 조기에 발견하고 관리자에게 경고합니다.

* **비인가 네트워크 장비 탐지 및 제거**

  * 비인가 장비(NAT 라우터 등)가 내부 네트워크에 무단으로 연결되면 보안 정책을 우회하여 침입이 가능합니다. SNMP 데이터와 TTL(Time to Live), ARP 정보 등 네트워크 프로토콜 데이터를 분석하여 비인가 장비를 탐지하고 제거합니다.
  * 이를 통해 비정상 데이터 발생을 최소화하고 데이터의 무결성을 유지합니다.

### 🔹 수집 데이터의 주요 특성 및 활용

* **패킷 데이터와 세션 정보 수집**

  * Arkime로 세션 단위 트래픽 데이터를 수집하여, 세션 길이, 지속 시간, TCP 플래그 등 82개 이상의 메타데이터 항목을 확보하고 분석에 활용합니다.
  * 수집된 데이터는 VAE(Variational Autoencoder)를 활용한 이상 탐지 모델의 학습 데이터로 사용됩니다.

* **스위치 포트 통계 데이터 활용**

  * 포트별로 수집된 다변량 통계 데이터(트래픽 크기, 오류율, 브로드캐스트 등)를 통해 특정 단말이나 포트의 이상 징후를 실시간으로 파악합니다.
  * 이 데이터는 이상 징후 판단을 위한 모델 학습과 평가 시 중요한 입력 자료가 됩니다.

* **통계적 모델링을 통한 이상 탐지**

  * 포아송 분포(Poisson Distribution)를 이용하여 단말의 서버 접근 빈도를 수치화·확률화하여 비정상 패턴을 신속히 탐지합니다.
  * 정상적인 사용 패턴과 비교하여 높은 확률로 이상이 의심되는 행위를 탐지하고 이를 통해 실시간 대응이 가능합니다.

